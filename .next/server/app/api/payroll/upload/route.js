"use strict";(()=>{var e={};e.id=684,e.ids=[684],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},96076:e=>{e.exports=require("rimraf")},27790:e=>{e.exports=require("assert")},78893:e=>{e.exports=require("buffer")},61282:e=>{e.exports=require("child_process")},9714:e=>{e.exports=require("constants")},84770:e=>{e.exports=require("crypto")},80665:e=>{e.exports=require("dns")},17702:e=>{e.exports=require("events")},92048:e=>{e.exports=require("fs")},20629:e=>{e.exports=require("fs/promises")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},98216:e=>{e.exports=require("net")},19801:e=>{e.exports=require("os")},55315:e=>{e.exports=require("path")},76162:e=>{e.exports=require("stream")},74026:e=>{e.exports=require("string_decoder")},82452:e=>{e.exports=require("tls")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},71568:e=>{e.exports=require("zlib")},61574:e=>{e.exports=import("@prisma/adapter-pg")},8678:e=>{e.exports=import("pg")},91180:(e,t,r)=>{r.a(e,async(e,o)=>{try{r.r(t),r.d(t,{originalPathname:()=>m,patchFetch:()=>d,requestAsyncStorage:()=>f,routeModule:()=>c,serverHooks:()=>p,staticGenerationAsyncStorage:()=>u});var a=r(49303),i=r(88716),n=r(60670),s=r(39844),l=e([s]);s=(l.then?(await l)():l)[0];let c=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/payroll/upload/route",pathname:"/api/payroll/upload",filename:"route",bundlePath:"app/api/payroll/upload/route"},resolvedPagePath:"C:\\hrms-project\\src\\app\\api\\payroll\\upload\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:f,staticGenerationAsyncStorage:u,serverHooks:p}=c,m="/api/payroll/upload/route";function d(){return(0,n.patchFetch)({serverHooks:p,staticGenerationAsyncStorage:u})}o()}catch(e){o(e)}})},39844:(e,t,r)=>{r.a(e,async(e,o)=>{try{r.r(t),r.d(t,{GET:()=>P,OPTIONS:()=>x,POST:()=>A});var a=r(87070),i=r(52850),n=r(92606),s=r(7371),l=r(71922),d=r(12957),c=r.n(d),f=r(20629),u=r(55315),p=r.n(u),m=r(29068),h=r(27305),g=e([i,l]);function y(e){return e.toString().replace(/\s+/g," ").replace(/\n/g," ").trim().toLowerCase()}[i,l]=g.then?(await g)():g;let N=e=>null==e||""===e?0:Number(e)||0,E={};for(let e of["Name","Resumption Date","No of Working Days in the Month","No of days Worked","Gross Pay","Prorated Gross Pay","Basic","Housing","Transport","Dressing","Leave Allowance","Entertainment","Utility","出勤薪资 Salary Of Attendance","PRORATED GROSS PAY WITH EXTRA ALL'WCE","TAXABLE INCOME","Consolidated Relief","Payee","Pension","Deduction","Bonus KPI","Net Salary","FINAL GROSS","Medical Contribution","Employer Pension","NSITF","Prorated Sub Total Invoice","Mgt Fee","Vat on Management Fee @7.5%","Total Invoice Value","EMAIL"])E[y(e)]=e;let v=["Gross Pay","Basic","Housing","Transport","Dressing","Leave Allowance","Entertainment","Utility","Payee","Pension","Deduction","Bonus KPI","Net Salary","FINAL GROSS","Medical Contribution","No of Working Days in the Month","No of days Worked"];function w(e,t){return e[E[y(t)]||t]}function S(e){for(let t of["Basic","Housing","Transport","Dressing","Leave Allowance","Entertainment","Utility","Medical Contribution"]){let r=w(e,t);if("string"==typeof r&&r.includes("%"))return!0}return!1}function R(e){let t=[],r="",o=!1;for(let a=0;a<e.length;a++){let i=e[a];if('"'===i&&'"'===e[a+1]){r+='"',a++;continue}if('"'===i){o=!o;continue}if(","===i&&!o){t.push(r.trim()),r="";continue}r+=i}return t.push(r.trim()),t}async function x(e){return(0,h.Ak)(e)}async function A(e){let t=e.headers.get("origin");try{let r=e.headers.get("authorization");if(!r)return(0,h.o3)(s.Rf.error("Authorization header missing",401),t);let o=r.replace("Bearer ",""),a=(0,n.MH)(o,["HR","SUPER_ADMIN"]);if(!a.companyId)return(0,h.o3)(s.Rf.error("Company context missing for this user",400),t);let d=a.companyId,u=await e.formData(),g=u.get("file"),x="true"===u.get("sendEmails");if(!g)return(0,h.o3)(s.Rf.error("File is required",400),t);let A=await g.arrayBuffer(),P=Buffer.from(A),T=g.name.split(".").pop()?.toLowerCase(),I="csv"===T||"text/csv"===g.type;if(!("xlsx"===T||"xls"===T)&&!I)return(0,h.o3)(s.Rf.error("Invalid file format. Please upload an Excel (.xlsx) or CSV (.csv) file.",400),t);let C=[];try{let e=new(c()).Workbook;if(I){let e=P.toString().split(/\r?\n/).filter(e=>e.trim());if(!e.length)throw Error("Empty CSV file");let t=R(e[0]).map(e=>E[y(e)]||e);for(let r=1;r<e.length;r++){let o=R(e[r]),a={};t.forEach((e,t)=>{a[e]=o[t]??""}),C.push(a)}C[0]&&S(C[0])&&(C=C.slice(1))}else{await e.xlsx.load(A);let t=e.worksheets[0];if(!t)throw Error("No worksheet found in Excel file");let r=t.getRow(1),o=[];r.eachCell((e,t)=>{let r=String(e.value||"").trim();o[t-1]=E[y(r)]||r});let a=t.getRow(2),i={};a.eachCell((e,t)=>{i[o[t-1]]=e.value});let n=S(i);t.eachRow({includeEmpty:!1},(e,t)=>{if(1===t||n&&2===t)return;let r={};e.eachCell((e,t)=>{r[o[t-1]]=e.value}),Object.values(r).some(e=>null!==e&&""!==e)&&C.push(r)})}}catch(e){return(0,h.o3)(s.Rf.error(`Error parsing file: ${e.message}`,400),t)}if(!C.length)return(0,h.o3)(s.Rf.error("No payroll data found in the file",400),t);let b={successful:0,failed:0,payslipsGenerated:0,emailsSent:0,processedRecords:[],failedRecords:[],errors:[]},$=new Date,D=$.toLocaleString("en-US",{month:"long"}),M=$.getFullYear();for(let e=0;e<C.length;e++){let t=C[e],r=e+3;try{let e=(w(t,"Name")||"").toString().trim(),o=(w(t,"EMAIL")||"").toString().trim();if(!e&&!o){let e="Missing Name/EMAIL for staff identification";b.failed++,b.errors.push(`Row ${r}: ${e}`),b.failedRecords.push({...t,error:e});continue}let n=v.filter(e=>{let r=w(t,e);return null==r||""===r});if(n.length){let e=`Missing required column values: ${n.join(", ")}`;b.failed++,b.errors.push(`Row ${r}: ${e}`),b.failedRecords.push({...t,error:e});continue}let s=null;if(o&&(s=await i._.staffRecord.findUnique({where:{email_companyId:{email:o,companyId:d}}})),!s&&e){let t=e.split(" ").filter(Boolean),r=t[0],o=t.slice(1).join(" ")||t[0];s=await i._.staffRecord.findFirst({where:{companyId:d,isActive:!0,OR:[{AND:[{firstName:{contains:r,mode:"insensitive"}},{lastName:{contains:o,mode:"insensitive"}}]},{AND:[{lastName:{contains:r,mode:"insensitive"}},{firstName:{contains:o,mode:"insensitive"}}]}]}})}if(!s){let a=`Staff record not found for ${e||o}. Staff must be pre-registered.`;b.failed++,b.errors.push(`Row ${r}: ${a}`),b.failedRecords.push({...t,error:a});continue}let c=t.Month?.toString()||t.MONTH?.toString()||D,f=parseInt(t.Year?.toString()||t.YEAR?.toString()||M.toString(),10),u=function(e){if(!e)return 0;let t=e.toString().trim().toLowerCase(),r=["january","february","march","april","may","june","july","august","september","october","november","december"].indexOf(t);if(r>=0)return r+1;let o=Number(t);return Number.isFinite(o)?o:0}(c),h=N(w(t,"Gross Pay")),g=N(w(t,"Prorated Gross Pay")),y=N(w(t,"Basic")),S=N(w(t,"Housing")),R=N(w(t,"Transport")),A=N(w(t,"Dressing")),P=N(w(t,"Leave Allowance")),E=N(w(t,"Entertainment")),T=N(w(t,"Utility")),I=N(w(t,"Payee")),C=N(w(t,"Pension")),$=N(w(t,"Deduction")),F=N(w(t,"Bonus KPI")),O=N(w(t,"Net Salary")),k=N(w(t,"FINAL GROSS")),q=N(w(t,"Medical Contribution")),L=N(w(t,"PRORATED GROSS PAY WITH EXTRA ALL'WCE")),z=N(w(t,"TAXABLE INCOME")),G=N(w(t,"Consolidated Relief")),B=12*C,_=12*h,W=N(w(t,"Employer Pension")),j=N(w(t,"NSITF")),H=N(w(t,"Prorated Sub Total Invoice")),U=N(w(t,"Mgt Fee")),Y=N(w(t,"Vat on Management Fee @7.5%")),V=N(w(t,"Total Invoice Value")),X=N(w(t,"No of Working Days in the Month")),K=N(w(t,"No of days Worked"));if(O<0){let e="Net Salary cannot be negative. Check payroll values.";b.failed++,b.errors.push(`Row ${r}: ${e}`),b.failedRecords.push({...t,error:e});continue}let J=await i._.payroll.upsert({where:{staffRecordId_month_year_companyId:{staffRecordId:s.id,month:c,year:f,companyId:d}},update:{companyId:d,month:c,year:f,grossPay:h,proratedGrossPay:g,basicSalary:y,housing:S,transport:R,dressing:A,leaveAllowance:P,entertainment:E,utility:T,proratedGrossWithExtra:L,annualPension:B,annualGrossPay:_,consolidatedRelief:G,taxableIncome:z,deductions:$,payee:I,pensionDeduction:C,bonusKPI:F,netSalary:O,finalGross:k,medicalContribution:q,employerPension:W,nsitf:j,proratedSubTotal:H,managementFee:U,vatOnManagementFee:Y,totalInvoiceValue:V,status:"PROCESSED",uploadedBy:a.userId},create:{companyId:d,staffRecordId:s.id,month:c,year:f,grossPay:h,proratedGrossPay:g,basicSalary:y,housing:S,transport:R,dressing:A,leaveAllowance:P,entertainment:E,utility:T,proratedGrossWithExtra:L,annualPension:B,annualGrossPay:_,consolidatedRelief:G,taxableIncome:z,deductions:$,payee:I,pensionDeduction:C,bonusKPI:F,netSalary:O,finalGross:k,medicalContribution:q,employerPension:W,nsitf:j,proratedSubTotal:H,managementFee:U,vatOnManagementFee:Y,totalInvoiceValue:V,status:"PROCESSED",uploadedBy:a.userId}}),Z=await i._.payslip.findFirst({where:{staffRecordId:s.id,month:c,year:f,companyId:d}}),Q=null;if(!Z){let e={rowNumber:r,staffId:s.staffId,email:s.email,fullName:`${s.firstName} ${s.lastName}`,periodMonth:u,periodYear:f,basicSalary:y,housingAllowance:S,transportAllowance:R,transportationAllowance:A,otherAllowances:P+E+T,grossPay:h,payee:I,pension:C,netPay:O,daysInMonth:X,daysWorked:K,rawRow:t};try{let{pdfPath:t}=await (0,m._)({staff:{staffId:s.staffId,firstName:s.firstName,lastName:s.lastName,email:s.email,department:s.department||void 0,designation:s.position||void 0},payroll:e});Q=t,b.payslipsGenerated++}catch(o){let e=`Failed to generate payslip PDF - ${o.message}`;b.failed++,b.errors.push(`Row ${r}: ${e}`),b.failedRecords.push({...t,error:e});continue}try{let e=p().basename(Q);await i._.payslip.create({data:{payrollId:J.id,staffRecordId:s.id,companyId:d,filePath:Q,fileName:e,month:c,year:f,grossPay:h,netPay:O}})}catch(o){let e=`Payslip DB record error - ${o.message}`;b.failed++,b.errors.push(`Row ${r}: ${e}`),b.failedRecords.push({...t,error:e});continue}}if(x)try{await (0,l.f)(s,{month:c,year:f,netSalary:O}),b.emailsSent++}catch(t){let e=`Email sending failed - ${t.message}`;b.errors.push(`Row ${r}: ${e}`)}b.successful++,b.processedRecords.push({...t,staffId:s.staffId,staffName:`${s.firstName} ${s.lastName}`,netSalary:O,status:"PROCESSED"})}catch(o){let e=o?.message||"Unknown error";b.failed++,b.errors.push(`Row ${r}: ${e}`),b.failedRecords.push({...t,error:e})}}let F=p().join(process.cwd(),"uploads","payroll");await (0,f.mkdir)(F,{recursive:!0});let O=null;if(b.failedRecords.length>0){let e=new(c()).Workbook,t=e.addWorksheet("Failed Records"),r=new Set;b.failedRecords.forEach(e=>Object.keys(e).forEach(e=>r.add(e))),r.add("error");let o=Array.from(r);t.columns=o.map(e=>({header:e,key:e,width:22})),b.failedRecords.forEach(e=>{t.addRow(e)});let a=t.getRow(1);a.font={bold:!0,color:{argb:"FFFFFFFF"}},a.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFDC3545"}};let i=`failed-records-${Date.now()}.xlsx`,n=p().join(F,i),s=await e.xlsx.writeBuffer();await (0,f.writeFile)(n,Buffer.from(s)),O=n}let k=await i._.payrollUpload.create({data:{companyId:d,fileName:g.name,filePath:p().join(F,g.name),processedFilePath:O,processedFileName:O?p().basename(O):null,totalRecords:C.length,successful:b.successful,failed:b.failed,errors:b.errors,uploadedBy:a.userId}});await (0,f.writeFile)(p().join(F,g.name),P);let q={results:b,uploadId:k.id,summary:{totalProcessed:C.length,successful:b.successful,failed:b.failed,payslipsGenerated:b.payslipsGenerated,emailsSent:b.emailsSent}};return b.failedRecords.length>0&&(q.failedRecordsDownload=`/api/payroll/download-failed/${k.id}`),(0,h.o3)(s.Rf.success(q,"Payroll processing completed successfully"),t)}catch(e){return(0,h.o3)((0,s.zG)(e),t)}}async function P(e){let t=e.headers.get("origin");try{let r=e.headers.get("authorization");if(!r)return(0,h.o3)(s.Rf.error("Authorization header missing",401),t);let o=r.replace("Bearer ","");(0,n.MH)(o,["HR","SUPER_ADMIN"]);let i=new(c()).Workbook,l=i.addWorksheet("Payroll Template");l.addRow(["Name","Resumption Date","No of Working Days in the Month"," No of days Worked ","Gross Pay","Prorated Gross Pay","Basic","Housing","Transport","Dressing","Leave Allowance","Entertainment","Utility","Salary Of Attendance ","PRORATED GROSS PAY WITH EXTRA ALL'WCE","TAXABLE INCOME","Payee","Pension","Deduction ","Bonus KPI ","Net Salary","FINAL GROSS","Medical Contribution","Employer Pension","NSITF","Prorated Sub Total\nInvoice","Mgt Fee","Vat on Management Fee @7.5%","Total Invoice\nValue","EMAIL"]),l.addRow(["","","","","","","50%","25%","25%","10%","8.33%","5%","5%","","","","","","","","","","1%","10%","","","","","",""]),l.addRow(["IMPORTANT:"]),l.addRow(["- All amounts should be in Naira"]),l.addRow(["- Staff must be pre-registered in the system"]),l.addRow(["- Name or EMAIL must match exactly with registered staff record"]),l.addRow(["- If a required column is missing in a row, that row will fail and be included in failed-records download."]);let d=await i.xlsx.writeBuffer(),f=new a.NextResponse(d,{headers:{"Content-Type":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","Content-Disposition":'attachment; filename="payroll-template.xlsx"',"Cache-Control":"no-cache"}});return(0,h.o3)(f,t)}catch(e){return(0,h.o3)((0,s.zG)(e),t)}}o()}catch(e){o(e)}})},92606:(e,t,r)=>{r.d(t,{MH:()=>d,fT:()=>n,mk:()=>l});var o=r(41482),a=r.n(o);function i(){let e=process.env.JWT_SECRET;if(!e)throw Error("JWT_SECRET environment variable is not set");return e}function n(e,t="7d"){return a().sign(e,i(),{expiresIn:t})}r(42023);let s=e=>{try{return a().verify(e,i())}catch{return null}},l=e=>{if(!e)throw Error("Authentication required");let t=s(e);if(!t)throw Error("Invalid or expired token");return t},d=(e,t)=>{let r=l(e);if(!t.includes(r.role))throw Error("Insufficient permissions");return r}},27305:(e,t,r)=>{r.d(t,{Ak:()=>n,o3:()=>i});var o=r(87070);let a=["http://localhost:5173","http://localhost:5173"].filter(Boolean);function i(e,t){return Object.entries(function(e){let t=e?a.includes(e)?e:void 0:a[0],r={"Access-Control-Allow-Methods":"GET,POST,PUT,PATCH,DELETE,OPTIONS","Access-Control-Allow-Headers":"Content-Type, Authorization","Access-Control-Allow-Credentials":"true"};return t&&(r["Access-Control-Allow-Origin"]=t),r}(t)).forEach(([t,r])=>{e.headers.set(t,r)}),e}function n(e){let t=e.headers.get("origin");return i(new o.NextResponse(null,{status:200}),t)}},52850:(e,t,r)=>{r.a(e,async(e,o)=>{try{r.d(t,{_:()=>y});var a=r(53524),i=r(61574),n=r(8678),s=r(92048),l=r.n(s),d=r(55315),c=r.n(d),f=e([i,n]);[i,n]=f.then?(await f)():f;let u=globalThis,p=c().join(process.cwd(),"certs","aiven-ca.pem"),m=l().readFileSync(p,"utf8"),h=u.pool??new n.Pool({connectionString:process.env.DATABASE_URL,ssl:{ca:m,rejectUnauthorized:!1}}),g=new i.PrismaPg(h),y=u.prisma??new a.PrismaClient({adapter:g,log:["query","error","warn"]});o()}catch(e){o(e)}})},71922:(e,t,r)=>{r.a(e,async(e,o)=>{try{r.d(t,{f:()=>s});var a=r(55245),i=r(52850),n=e([i]);i=(n.then?(await n)():n)[0];let l=a.createTransport({host:process.env.SMTP_HOST||"smtp.gmail.com",port:parseInt(process.env.SMTP_PORT||"587"),secure:!1,auth:{user:process.env.SMTP_USER,pass:process.env.SMTP_PASS}});async function s(e,t){let r=await i._.company.findUnique({where:{id:e.companyId}}),o=`${process.env.NEXTAUTH_URL}/profile`,a={from:r?.email||process.env.SMTP_FROM||"no-reply@hrms.com",to:e.email,subject:`Your Payslip for ${t.month} ${t.year}`,html:`
      <html>
      <body style="font-family: Arial, sans-serif;">
        <div style="max-width: 600px; margin: auto;">
          <div style="background-color: #2c5530; color: white; padding: 20px;">
            <h1 style="margin:0;">${r?.companyName||"Your Company"}</h1>
            <h3 style="margin:0;">Payslip Notification</h3>
          </div>

          <div style="padding: 20px; background: #f9f9f9;">
            <p>Hello ${e.firstName} ${e.lastName},</p>
            <p>Your payslip for <strong>${t.month} ${t.year}</strong> is ready.</p>

            <p><strong>Net Salary:</strong> ₦${Number(t.netSalary||t.netPay).toLocaleString("en-NG",{minimumFractionDigits:2})}</p>

            <p>Department: ${e.department}</p>

            <p style="text-align:center; margin-top:20px;">
              <a href="${o}"
                 style="background:#2c5530;color:white;padding:10px 20px;
                 border-radius:6px;text-decoration:none;">
                View Payslip
              </a>
            </p>

            <p>Best regards,<br>${r?.companyName} HR</p>
          </div>
        </div>
      </body>
      </html>
    `};await l.sendMail(a)}o()}catch(e){o(e)}})},29068:(e,t,r)=>{r.d(t,{_:()=>f});let o=require("pdfkit");var a=r.n(o),i=r(20629),n=r(92048),s=r.n(n),l=r(55315),d=r.n(l);function c(e){let t=Number.isFinite(e)?e:0;return`₦${t.toLocaleString("en-NG",{minimumFractionDigits:2})}`}async function f(e){let{staff:t,payroll:r}=e,o=d().join(process.cwd(),"public","payslips");await (0,i.mkdir)(o,{recursive:!0});let n=r.periodMonth.toString().padStart(2,"0"),l=`payslip-${t.staffId}-${n}-${r.periodYear}`,f=`${l}.pdf`,u=d().join(o,f);s().existsSync(u)&&(f=`${l}-${Date.now()}.pdf`,u=d().join(o,f));let p=new(a())({margin:40,size:"A4"}),m=s().createWriteStream(u);p.pipe(m),p.rect(0,0,p.page.width,80).fill("#1e3a5f"),p.fillColor("#ffffff").fontSize(18).text(t.companyName||"COMPANY NAME LTD",40,25),p.fontSize(11).text("Salary Payslip",40,50),p.fillColor("#000000").fontSize(10).text(`Pay Period: ${n}/${r.periodYear}`,p.page.width-220,30).text(`Generated: ${new Date().toLocaleDateString()}`,p.page.width-220,45),p.roundedRect(40,100,p.page.width-80,90,6).fill("#f3f6fb"),p.fillColor("#000000").fontSize(11).text(`Staff Name: ${t.firstName} ${t.lastName}`,55,115).text(`Staff ID: ${t.staffId}`,55,132).text(`Email: ${t.email}`,55,149),p.text(`Department: ${t.department||"N/A"}`,p.page.width/2+10,115).text(`Designation: ${t.designation||"N/A"}`,p.page.width/2+10,132);let h=215;p.fontSize(12).fillColor("#1e3a5f").text("EARNINGS",40,h),h+=15,p.moveTo(40,h).lineTo(p.page.width-40,h).stroke("#1e3a5f"),h+=10;let g=[["Basic Salary",r.basicSalary],["Housing Allowance",r.housingAllowance],["Transport Allowance",r.transportAllowance],["Dressing / Transportation",r.transportationAllowance],["Other Allowances",r.otherAllowances]];for(let[e,t]of(p.fontSize(10).fillColor("#000000"),g))p.text(e,50,h),p.text(c(t),p.page.width-180,h,{width:130,align:"right"}),h+=18;p.fontSize(11).fillColor("#0f5132").text("Total Gross Pay",50,h+5),p.fontSize(11).fillColor("#0f5132").text(c(r.grossPay),p.page.width-180,h+5,{width:130,align:"right"}),h+=35,p.fontSize(12).fillColor("#8b0000").text("DEDUCTIONS",40,h),h+=15,p.moveTo(40,h).lineTo(p.page.width-40,h).stroke("#8b0000"),h+=10;let y=[["PAYE",r.payee],["Pension",r.pension]];for(let[e,t]of(p.fontSize(10).fillColor("#000000"),y))p.text(e,50,h),p.text(c(t),p.page.width-180,h,{width:130,align:"right"}),h+=18;let w=r.payee+r.pension;return p.fontSize(11).fillColor("#8b0000").text("Total Deductions",50,h+5),p.fontSize(11).fillColor("#8b0000").text(c(w),p.page.width-180,h+5,{width:130,align:"right"}),h+=45,p.roundedRect(40,h,p.page.width-80,45,6).fill("#e8f0ff"),p.fillColor("#0b1f44").fontSize(14).text("NET SALARY",55,h+13),p.fillColor("#0b1f44").fontSize(14).text(c(r.netPay),p.page.width-200,h+13,{width:150,align:"right"}),h+=70,p.fillColor("#000000").fontSize(10).text(`Working Days In Month: ${r.daysInMonth}`,50,h).text(`Days Worked: ${r.daysWorked}`,p.page.width/2+10,h),p.fontSize(8).fillColor("#666666").text("This is a system-generated payslip. No signature required.",40,p.page.height-40,{align:"center",width:p.page.width-80}),p.end(),await new Promise((e,t)=>{m.on("finish",()=>e()),m.on("error",t)}),{pdfPath:`/payslips/${f}`}}},7371:(e,t,r)=>{r.d(t,{Rf:()=>a,Z:()=>i,zG:()=>n});var o=r(87070);class a{static success(e,t="Success",r=200){return o.NextResponse.json({success:!0,message:t,data:e},{status:r})}static error(e="Error",t=400,r){return o.NextResponse.json({success:!1,message:e,errors:r||[]},{status:t})}static unauthorized(e="Unauthorized"){return this.error(e,401)}static forbidden(e="Forbidden"){return this.error(e,403)}static notFound(e="Resource not found"){return this.error(e,404)}static serverError(e="Internal server error"){return this.error(e,500)}}function i(e){if(e instanceof Error)return e.message;if("string"==typeof e)return e;try{return JSON.stringify(e)}catch{return"An unexpected error occurred"}}let n=e=>{console.error("API Error:",e);let t=i(e);return a.error(t,500)}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[377,972,944,957,245],()=>r(91180));module.exports=o})();