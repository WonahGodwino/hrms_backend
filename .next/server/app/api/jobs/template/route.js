"use strict";(()=>{var e={};e.id=230,e.ids=[230],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},96076:e=>{e.exports=require("rimraf")},27790:e=>{e.exports=require("assert")},78893:e=>{e.exports=require("buffer")},9714:e=>{e.exports=require("constants")},84770:e=>{e.exports=require("crypto")},17702:e=>{e.exports=require("events")},92048:e=>{e.exports=require("fs")},19801:e=>{e.exports=require("os")},55315:e=>{e.exports=require("path")},76162:e=>{e.exports=require("stream")},74026:e=>{e.exports=require("string_decoder")},21764:e=>{e.exports=require("util")},71568:e=>{e.exports=require("zlib")},91398:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>g,patchFetch:()=>A,requestAsyncStorage:()=>m,routeModule:()=>f,serverHooks:()=>v,staticGenerationAsyncStorage:()=>x});var o={};t.r(o),t.d(o,{GET:()=>h,OPTIONS:()=>d});var n=t(49303),i=t(88716),s=t(60670),a=t(92606),u=t(7371),p=t(12957),c=t.n(p),l=t(27305);async function d(e){return(0,l.Ak)(e)}async function h(e){let r=e.headers.get("origin");try{let t=e.headers.get("authorization");if(!t)return(0,l.o3)(u.Rf.error("Authorization header missing",401),r);let o=t.replace("Bearer ","");(0,a.MH)(o,["HR","SUPER_ADMIN"]);let n=new(c()).Workbook,i=n.addWorksheet("Job Advertisement Template");i.columns=[{header:"Title",key:"title",width:30},{header:"Description",key:"description",width:50},{header:"Department",key:"department",width:20},{header:"Position",key:"position",width:20},{header:"Expiration Date",key:"expirationDate",width:20}],i.addRow({title:"Job Title",description:"Job Description",department:"Department Name",position:"Job Position",expirationDate:"YYYY-MM-DD"});let s=await n.xlsx.writeBuffer(),p=new Response(s,{headers:{"Content-Type":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","Content-Disposition":'attachment; filename="job_advertisement_template.xlsx"',"Cache-Control":"no-cache"}});return(0,l.o3)(p,r)}catch(e){return(0,l.o3)(u.Rf.error(e.message||"Error generating template",500),r)}}let f=new n.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/jobs/template/route",pathname:"/api/jobs/template",filename:"route",bundlePath:"app/api/jobs/template/route"},resolvedPagePath:"C:\\hrms-project\\src\\app\\api\\jobs\\template\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:m,staticGenerationAsyncStorage:x,serverHooks:v}=f,g="/api/jobs/template/route";function A(){return(0,s.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:x})}},92606:(e,r,t)=>{t.d(r,{MH:()=>p,fT:()=>s,mk:()=>u});var o=t(41482),n=t.n(o);function i(){let e=process.env.JWT_SECRET;if(!e)throw Error("JWT_SECRET environment variable is not set");return e}function s(e,r="7d"){return n().sign(e,i(),{expiresIn:r})}t(42023);let a=e=>{try{return n().verify(e,i())}catch{return null}},u=e=>{if(!e)throw Error("Authentication required");let r=a(e);if(!r)throw Error("Invalid or expired token");return r},p=(e,r)=>{let t=u(e);if(!r.includes(t.role))throw Error("Insufficient permissions");return t}},27305:(e,r,t)=>{t.d(r,{Ak:()=>s,o3:()=>i});var o=t(87070);let n=["http://localhost:5173","http://localhost:5173"].filter(Boolean);function i(e,r){return Object.entries(function(e){let r=e?n.includes(e)?e:void 0:n[0],t={"Access-Control-Allow-Methods":"GET,POST,PUT,PATCH,DELETE,OPTIONS","Access-Control-Allow-Headers":"Content-Type, Authorization","Access-Control-Allow-Credentials":"true"};return r&&(t["Access-Control-Allow-Origin"]=r),t}(r)).forEach(([r,t])=>{e.headers.set(r,t)}),e}function s(e){let r=e.headers.get("origin");return i(new o.NextResponse(null,{status:200}),r)}},7371:(e,r,t)=>{t.d(r,{Rf:()=>n,Z:()=>i,zG:()=>s});var o=t(87070);class n{static success(e,r="Success",t=200){return o.NextResponse.json({success:!0,message:r,data:e},{status:t})}static error(e="Error",r=400,t){return o.NextResponse.json({success:!1,message:e,errors:t||[]},{status:r})}static unauthorized(e="Unauthorized"){return this.error(e,401)}static forbidden(e="Forbidden"){return this.error(e,403)}static notFound(e="Resource not found"){return this.error(e,404)}static serverError(e="Internal server error"){return this.error(e,500)}}function i(e){if(e instanceof Error)return e.message;if("string"==typeof e)return e;try{return JSON.stringify(e)}catch{return"An unexpected error occurred"}}let s=e=>{console.error("API Error:",e);let r=i(e);return n.error(r,500)}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[377,972,944,957],()=>t(91398));module.exports=o})();