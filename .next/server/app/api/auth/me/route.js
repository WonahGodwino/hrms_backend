"use strict";(()=>{var r={};r.id=788,r.ids=[788],r.modules={53524:r=>{r.exports=require("@prisma/client")},20399:r=>{r.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:r=>{r.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:r=>{r.exports=require("buffer")},84770:r=>{r.exports=require("crypto")},76162:r=>{r.exports=require("stream")},21764:r=>{r.exports=require("util")},61574:r=>{r.exports=import("@prisma/adapter-pg")},8678:r=>{r.exports=import("pg")},62718:(r,e,t)=>{t.a(r,async(r,o)=>{try{t.r(e),t.d(e,{originalPathname:()=>h,patchFetch:()=>c,requestAsyncStorage:()=>d,routeModule:()=>p,serverHooks:()=>l,staticGenerationAsyncStorage:()=>m});var a=t(49303),n=t(88716),s=t(60670),i=t(97882),u=r([i]);i=(u.then?(await u)():u)[0];let p=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/auth/me/route",pathname:"/api/auth/me",filename:"route",bundlePath:"app/api/auth/me/route"},resolvedPagePath:"C:\\hrms-project\\src\\app\\api\\auth\\me\\route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:d,staticGenerationAsyncStorage:m,serverHooks:l}=p,h="/api/auth/me/route";function c(){return(0,s.patchFetch)({serverHooks:l,staticGenerationAsyncStorage:m})}o()}catch(r){o(r)}})},97882:(r,e,t)=>{t.a(r,async(r,o)=>{try{t.r(e),t.d(e,{GET:()=>u});var a=t(52850),n=t(92606),s=t(7371),i=r([a]);async function u(r){try{let e=r.headers.get("authorization");if(!e)return s.Rf.error("Authorization header missing",401);let t=e.replace("Bearer ",""),o=(0,n.mk)(t),i=await a._.staffRecord.findFirst({where:{id:o.userId,...o.companyId?{companyId:o.companyId}:{}},include:{company:!0}});if(!i)return s.Rf.error("User not found",404);return s.Rf.success({user:{id:i.id,email:i.email,firstName:i.firstName,lastName:i.lastName,role:i.role,companyId:i.companyId,department:i.department,position:i.position,isActive:i.isActive,staffId:i.staffId},company:i.company?{id:i.company.id,companyName:i.company.companyName,email:i.company.email,phone:i.company.phone,address:i.company.address}:null})}catch(r){return(0,s.zG)(r)}}a=(i.then?(await i)():i)[0],o()}catch(r){o(r)}})},92606:(r,e,t)=>{t.d(e,{MH:()=>c,fT:()=>s,mk:()=>u});var o=t(41482),a=t.n(o);function n(){let r=process.env.JWT_SECRET;if(!r)throw Error("JWT_SECRET environment variable is not set");return r}function s(r,e="7d"){return a().sign(r,n(),{expiresIn:e})}t(42023);let i=r=>{try{return a().verify(r,n())}catch{return null}},u=r=>{if(!r)throw Error("Authentication required");let e=i(r);if(!e)throw Error("Invalid or expired token");return e},c=(r,e)=>{let t=u(r);if(!e.includes(t.role))throw Error("Insufficient permissions");return t}},52850:(r,e,t)=>{t.a(r,async(r,o)=>{try{t.d(e,{_:()=>d});var a=t(53524),n=t(61574),s=t(8678),i=r([n,s]);[n,s]=i.then?(await i)():i;let u=globalThis,c=u.pool??new s.Pool({connectionString:process.env.DATABASE_URL,ssl:{rejectUnauthorized:!1}}),p=new n.PrismaPg(c),d=u.prisma??new a.PrismaClient({adapter:p,log:["query","error","warn"]});o()}catch(r){o(r)}})},7371:(r,e,t)=>{t.d(e,{Rf:()=>a,zG:()=>n});var o=t(87070);class a{static success(r,e="Success",t=200){return o.NextResponse.json({success:!0,message:e,data:r},{status:t})}static error(r="Error",e=400,t){return o.NextResponse.json({success:!1,message:r,errors:t||[]},{status:e})}static unauthorized(r="Unauthorized"){return this.error(r,401)}static forbidden(r="Forbidden"){return this.error(r,403)}static notFound(r="Resource not found"){return this.error(r,404)}static serverError(r="Internal server error"){return this.error(r,500)}}let n=r=>(console.error("API Error:",r),r instanceof Error)?a.error(r.message):a.serverError()}};var e=require("../../../../webpack-runtime.js");e.C(r);var t=r=>e(e.s=r),o=e.X(0,[377,443,70],()=>t(62718));module.exports=o})();