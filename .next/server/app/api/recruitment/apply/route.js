"use strict";(()=>{var e={};e.id=645,e.ids=[645],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},92048:e=>{e.exports=require("fs")},55315:e=>{e.exports=require("path")},61574:e=>{e.exports=import("@prisma/adapter-pg")},8678:e=>{e.exports=import("pg")},12899:(e,r,t)=>{t.a(e,async(e,o)=>{try{t.r(r),t.d(r,{originalPathname:()=>f,patchFetch:()=>u,requestAsyncStorage:()=>l,routeModule:()=>p,serverHooks:()=>h,staticGenerationAsyncStorage:()=>d});var n=t(49303),s=t(88716),a=t(60670),i=t(8125),c=e([i]);i=(c.then?(await c)():c)[0];let p=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/recruitment/apply/route",pathname:"/api/recruitment/apply",filename:"route",bundlePath:"app/api/recruitment/apply/route"},resolvedPagePath:"C:\\hrms-project\\src\\app\\api\\recruitment\\apply\\route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:l,staticGenerationAsyncStorage:d,serverHooks:h}=p,f="/api/recruitment/apply/route";function u(){return(0,a.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:d})}o()}catch(e){o(e)}})},8125:(e,r,t)=>{t.a(e,async(e,o)=>{try{t.r(r),t.d(r,{OPTIONS:()=>c,POST:()=>u});var n=t(52850),s=t(7371),a=t(27305),i=e([n]);async function c(e){return(0,a.Ak)(e)}async function u(e){let r=e.headers.get("origin");try{let t=e.headers.get("authorization");if(!t)return(0,a.o3)(s.Rf.error("Authorization header missing",401),r);let o=t.replace("Bearer ",""),i=requireRole(o,["STAFF"]),{jobId:c}=await e.json();if(!c)return(0,a.o3)(s.Rf.error("Job ID is required",400),r);let u=await n._.job.findUnique({where:{id:c}});if(!u)return(0,a.o3)(s.Rf.error("Job not found",404),r);if(u.expirationDate<new Date)return(0,a.o3)(s.Rf.error("Job posting has expired",400),r);let p=await n._.jobApplication.create({data:{jobId:u.id,firstName:i.firstName,lastName:i.lastName,email:i.email,cv:"",status:"PENDING"}});return(0,a.o3)(s.Rf.success(p,"Application submitted successfully"),r)}catch(e){return(0,a.o3)(s.Rf.error(e.message,500),r)}}n=(i.then?(await i)():i)[0],o()}catch(e){o(e)}})},27305:(e,r,t)=>{t.d(r,{Ak:()=>a,o3:()=>s});var o=t(87070);let n=["http://localhost:5173","http://localhost:5173"].filter(Boolean);function s(e,r){return Object.entries(function(e){let r=e?n.includes(e)?e:void 0:n[0],t={"Access-Control-Allow-Methods":"GET,POST,PUT,PATCH,DELETE,OPTIONS","Access-Control-Allow-Headers":"Content-Type, Authorization","Access-Control-Allow-Credentials":"true"};return r&&(t["Access-Control-Allow-Origin"]=r),t}(r)).forEach(([r,t])=>{e.headers.set(r,t)}),e}function a(e){let r=e.headers.get("origin");return s(new o.NextResponse(null,{status:200}),r)}},52850:(e,r,t)=>{t.a(e,async(e,o)=>{try{t.d(r,{_:()=>A});var n=t(53524),s=t(61574),a=t(8678),i=t(92048),c=t.n(i),u=t(55315),p=t.n(u),l=e([s,a]);[s,a]=l.then?(await l)():l;let d=globalThis,h=p().join(process.cwd(),"certs","aiven-ca.pem"),f=c().readFileSync(h,"utf8"),m=d.pool??new a.Pool({connectionString:process.env.DATABASE_URL,ssl:{ca:f,rejectUnauthorized:!1}}),g=new s.PrismaPg(m),A=d.prisma??new n.PrismaClient({adapter:g,log:["query","error","warn"]});o()}catch(e){o(e)}})},7371:(e,r,t)=>{t.d(r,{Rf:()=>n,Z:()=>s,zG:()=>a});var o=t(87070);class n{static success(e,r="Success",t=200){return o.NextResponse.json({success:!0,message:r,data:e},{status:t})}static error(e="Error",r=400,t){return o.NextResponse.json({success:!1,message:e,errors:t||[]},{status:r})}static unauthorized(e="Unauthorized"){return this.error(e,401)}static forbidden(e="Forbidden"){return this.error(e,403)}static notFound(e="Resource not found"){return this.error(e,404)}static serverError(e="Internal server error"){return this.error(e,500)}}function s(e){if(e instanceof Error)return e.message;if("string"==typeof e)return e;try{return JSON.stringify(e)}catch{return"An unexpected error occurred"}}let a=e=>{console.error("API Error:",e);let r=s(e);return n.error(r,500)}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[377,972],()=>t(12899));module.exports=o})();